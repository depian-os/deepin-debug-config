#!/bin/bash
set -e

readonly MODULES_DEBUG_LEVELS_PATH="/var/lib/deepin-debug-config/deepin-debug-levels.cfg"
readonly MODULES_DEBUG_LEVELS_PATH_OLD_VERSION="/usr/share/deepin-debug-config/deepin-debug-levels.cfg"

readonly DEBUG_APT_SOURCE_LISTS="/var/lib/deepin-debug-config/lists"
readonly DEBUG_APT_SOURCE_CACHE_BIN="/var/lib/deepin-debug-config/safecache_pkgcache.bin"
readonly DEBUG_APT_SOURCE_CACHE_DIR="/var/cache/deepin-debug-config"

readonly JOURNAL_LOG_ON_INSTALLED="/etc/systemd/journald.conf.d/00-on-deepin-config-debug.conf"
readonly JOURNAL_LOG_OFF_INSTALLED="/etc/systemd/journald.conf.d/00-off-deepin-config-debug.conf"

function rm_file_if_exists {
    if [ -f "$1" ]; then
		rm -f "$1"
    fi
}

function rm_dir_if_exists {
    if [ -d "$1" ]; then
		rm -rf "$1"
    fi
}

function clear_log_cfg {
	rm_file_if_exists "$JOURNAL_LOG_OFF_INSTALLED"
	rm_file_if_exists "$JOURNAL_LOG_ON_INSTALLED"
}

function clear_debug_source_cache {
    rm_dir_if_exists "$DEBUG_APT_SOURCE_LISTS"
    rm_file_if_exists "$DEBUG_APT_SOURCE_CACHE_BIN"
    rm_dir_if_exists "$DEBUG_APT_SOURCE_CACHE_DIR"
}

function rm_level_cfg {
	rm_file_if_exists "$MODULES_DEBUG_LEVELS_PATH"
    rm_file_if_exists "$MODULES_DEBUG_LEVELS_PATH_OLD_VERSION"
}

case "$1" in
	purge)
        clear_debug_source_cache || true
        rm_level_cfg || true
		clear_log_cfg || true
	;;
	*)
	;;
esac
# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.
#DEBHELPER#

exit 0

